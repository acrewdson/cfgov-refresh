<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <title>Atomic structure and design - cfgov-refresh</title>
    
    

    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/syntax.css">
    

    <style type="text/css">
        
        .sidebar-nav a:hover,
        .sidebar-nav a:focus,
        .sidebar-nav a:active,
        .sidebar-nav a.sidebar-nav-active {
            border-left-color: #2CB34A;
        }
        header {
            border-bottom-color: #2CB34A;
        }
        
        

        
    </style>


    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
      <script src="../js/respond.min.js"></script>
    <![endif]--> 
</head>

<body>

    <div class="container">
        <header role="banner">
            <div class="wrap">
                
                <img class="logo" src="https://cfpb.github.io/img/logo_210.png" alt="Consumer Financial Protection Bureau">
                
                <h1 class="site-title"><a class="title-link" href="../">cfgov-refresh</a></h1>
            </div>
        </header>

        <div class="wrap content">
            <aside>
                <nav class="sidebar-nav" role="navigation">
                    <ul>
                        
                        <li>
                            
                            <a href=".." class="">Introduction</a>

                            
                        </li>
                        
                        <li>
                            
                            <a href="../installation/" class="">Installation</a>

                            
                        </li>
                        
                        <li>
                            
                            <a href="../usage/" class="">Usage</a>

                            
                        </li>
                        
                        <li>
                            
                            <span>Building and Deploying for cf.gov</span>
                            <ul class="secondary-nav">
                                
                                <li>
                                    <a href="../whats-new/" class="">What's new</a>
                                </li>
                                
                                <li>
                                    <a href="../new-projects/" class="">New projects</a>
                                </li>
                                
                                <li>
                                    <a href="../branching-merging/" class="">Branching and merging</a>
                                </li>
                                
                                <li>
                                    <a href="../release-cadence/" class="">Release cadence</a>
                                </li>
                                
                                <li>
                                    <a href="../deployment/" class="">Deployment</a>
                                </li>
                                
                                <li>
                                    <a href="../feature-flags/" class="">Feature flags</a>
                                </li>
                                
                            </ul>
                            
                        </li>
                        
                        <li>
                            
                            <span>Back-end guidelines</span>
                            <ul class="secondary-nav">
                                
                                <li>
                                    <a href="../wagtail-migrations/" class="">Wagtail and Django migrations</a>
                                </li>
                                
                                <li>
                                    <a href="../django-to-wagtail/" class="">Wagtail Pages vs Django views</a>
                                </li>
                                
                                <li>
                                    <a href="../translation/" class="">Translation</a>
                                </li>
                                
                            </ul>
                            
                        </li>
                        
                        <li>
                            
                            <span>Front-end guidelines</span>
                            <ul class="secondary-nav">
                                
                                <li>
                                    <a href="./" class="sidebar-nav-active">Atomic structure and design</a>
                                </li>
                                
                                <li>
                                    <a href="../notes-on-atomic-design/" class="">Notes on adapting atomic design</a>
                                </li>
                                
                                <li>
                                    <a href="../notes-on-frameworks/" class="">Notes on frameworks</a>
                                </li>
                                
                            </ul>
                            
                        </li>
                        
                        <li>
                            
                            <a href="../testing/" class="">Testing</a>

                            
                        </li>
                        
                        <li>
                            
                            <a href="../development-tips/" class="">Development tips</a>

                            
                        </li>
                        
                    </ul>
                </nav>
            </aside>

            <section id="main" class="main-content" role="main">
                <h1 id="notes-on-atomic-design">Notes on Atomic Design</h1>
<p>Check out <a href="http://www.ebaytechblog.com/?p=3113">Don't Build Pages, Build Modules</a>. It encompasses exactly what we are trying to achieve by building components using atomic design. It's important to note that our front-end atomic architecture is still evolving.</p>
<p>Our components are broken down into templates, organisms, molecules, and atoms. We opted not to use the page component, although it exists in atomic design. Our components are composed of HTML, CSS, and JavaScript. If a component doesn’t have user interactions or require styling, then it won’t have an associated js and/or css file. We compose our atomic components as follows:</p>
<h3 id="atoms">Atoms</h3>
<p>Prefixed with “a-” in CSS, JavaScript, and HTML files.</p>
<h4 id="html">HTML</h4>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;a-overlay u-hidden&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>


<h4 id="css">CSS</h4>
<div class="highlight"><pre><span></span> <span class="p">.</span><span class="nc">a-overlay</span> <span class="p">{</span>
        <span class="err">//</span> <span class="err">Only</span> <span class="err">show</span> <span class="err">overlay</span> <span class="err">at</span> <span class="err">mobile/tablet</span> <span class="err">size.</span>
        <span class="err">.respond-to-max(</span> <span class="err">@bp-sm-max,</span> <span class="err">{</span>
            <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
            <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</pre></div>


<h3 id="molecules">Molecules</h3>
<p>Prefixed with “m-” in CSS, JavaScript, and HTML files.</p>
<h4 id="html_1">HTML</h4>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;m-notification m-notification__error m-notification__visible&quot;</span> <span class="na">data-js-hook</span><span class="o">=</span><span class="s">&quot;state_atomic_init&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;m-notification_icon cf-icon&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;m-notification_content&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
 <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>


<h4 id="css_1">CSS</h4>
<div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">m-notification</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
    <span class="k">padding</span><span class="p">:</span> <span class="o">@</span><span class="n">m-notification-padding__px</span><span class="p">;</span>
    <span class="k">padding-left</span><span class="p">:</span> <span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
</pre></div>


<h4 id="javascript">JavaScript</h4>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">Notification</span><span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="p">{</span>
   <span class="c1">// eslint-disable-line max-statements, inline-comments, max-len</span>
   <span class="kd">var</span> <span class="nx">BASE_CLASS</span> <span class="o">=</span> <span class="s1">&#39;m-notification&#39;</span><span class="p">;</span>

   <span class="c1">// Constants for the state of this Notification.</span>
   <span class="kd">var</span> <span class="nx">SUCCESS</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">WARNING</span> <span class="o">=</span> <span class="s1">&#39;warning&#39;</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">ERROR</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span><span class="p">;</span>
   <span class="c1">// Constants for the Notification modifiers.</span>
   <span class="kd">var</span> <span class="nx">MODIFIER_VISIBLE</span> <span class="o">=</span> <span class="nx">BASE_CLASS</span> <span class="o">+</span> <span class="s1">&#39;__visible&#39;</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">_dom</span> <span class="o">=</span> <span class="nx">atomicHelpers</span><span class="p">.</span><span class="nx">checkDom</span><span class="p">(</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">BASE_CLASS</span> <span class="p">);</span>
   <span class="kd">var</span> <span class="nx">_contentDom</span> <span class="o">=</span> <span class="nx">_dom</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">BASE_CLASS</span> <span class="o">+</span> <span class="s1">&#39;_content&#39;</span> <span class="p">);</span>
</pre></div>


<p>The notification molecule can be instantiated with the following code:</p>
<div class="highlight"><pre><span></span><span class="nx">_notification</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Notification</span><span class="p">(</span> <span class="nx">_dom</span> <span class="p">);</span>
<span class="nx">_notification</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
</pre></div>


<h3 id="organisms">Organisms</h3>
<p>Prefixed with “o-” in CSS, JavaScript, and HTML.</p>
<h4 id="html_2">HTML</h4>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">data-qa-hook</span><span class="o">=</span><span class="s">&quot;expandable&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;o-expandable</span>
<span class="s">                                      o-expandable__borders</span>
<span class="s">                                      o-expandable__midtone</span>
<span class="s">                                      o-expandable__expanded&quot;</span>
                               <span class="na">data-js-hook</span><span class="o">=</span><span class="s">&quot;state_atomic_init&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;o-expandable_target&quot;</span> <span class="na">aria-pressed</span><span class="o">=</span><span class="s">&quot;true&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;o-expandable_header&quot;</span><span class="p">&gt;</span>
</pre></div>


<p>JavaScript:</p>
<div class="highlight"><pre><span></span> <span class="kd">function</span> <span class="nx">Expandable</span><span class="p">(</span> <span class="nx">element</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">BASE_CLASS</span> <span class="o">=</span> <span class="s1">&#39;o-expandable&#39;</span><span class="p">;</span>

  <span class="c1">// Bitwise flags for the state of this Expandable.</span>
  <span class="kd">var</span> <span class="nx">COLLAPSED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">COLLAPSING</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">EXPANDING</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">EXPANDED</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="c1">// The Expandable element will directly be the Expandable</span>
  <span class="c1">// when used in an ExpandableGroup, otherwise it can be the parent container.</span>
  <span class="kd">var</span> <span class="nx">_dom</span> <span class="o">=</span> <span class="nx">atomicHelpers</span><span class="p">.</span><span class="nx">checkDom</span><span class="p">(</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">BASE_CLASS</span> <span class="p">);</span>
  <span class="kd">var</span> <span class="nx">_target</span> <span class="o">=</span> <span class="nx">_dom</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">BASE_CLASS</span> <span class="o">+</span> <span class="s1">&#39;_target&#39;</span> <span class="p">);</span>
  <span class="kd">var</span> <span class="nx">_content</span> <span class="o">=</span> <span class="nx">_dom</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">BASE_CLASS</span> <span class="o">+</span> <span class="s1">&#39;_content&#39;</span> <span class="p">);</span>
</pre></div>


<p>The Expandable organism can be instantiated with the following code:</p>
<div class="highlight"><pre><span></span><span class="nx">_expandable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Expandable</span><span class="p">(</span> <span class="nx">_dom</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span> <span class="s1">&#39;.o-expandable&#39;</span> <span class="p">)</span> <span class="p">);</span>
<span class="nx">_expandable</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span> <span class="nx">_expandable</span><span class="p">.</span><span class="nx">EXPANDED</span> <span class="p">);</span>
</pre></div>


<p>or</p>
<div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">atomicHelpers</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;../../modules/util/atomic-helpers&#39;</span> <span class="p">);</span>
<span class="kd">var</span> <span class="nx">Expandable</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span> <span class="s1">&#39;../../organisms/Expandable&#39;</span> <span class="p">);</span>
<span class="nx">atomicHelpers</span><span class="p">.</span><span class="nx">instantiateAll</span><span class="p">(</span> <span class="s1">&#39;.o-expandable&#39;</span><span class="p">,</span> <span class="nx">Expandable</span> <span class="p">);</span>
</pre></div>


<h3 id="templates">Templates</h3>
<p>Prefixed with “t-” in CSS, JavaScript, and HTML.</p>
<h4 id="css_2">CSS</h4>
<div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">t-careers</span> <span class="p">{</span>
    <span class="err">&amp;_social</span> <span class="err">.m-social-media</span> <span class="err">{</span>
        <span class="k">float</span><span class="p">:</span> <span class="kc">right</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="err">…</span>
</pre></div>


<h3 id="folder-structure">Folder Structure</h3>
<p>Atomic code is currently separated and named based on asset type. This is a mistake in my view, as I believe we should begin migrating to a modular folder structure based on the component.</p>
<h4 id="current-structure">Current Structure</h4>
<h4 id="html_3">HTML</h4>
<div class="highlight"><pre><span></span>cfgov-refresh/cfgov/jinja2/v1/_includes/atoms/
cfgov-refresh/cfgov/jinja2/v1/_includes/molecules/
cfgov-refresh/cfgov/jinja2/v1/_includes/organisms/
</pre></div>


<h4 id="css_3">CSS</h4>
<div class="highlight"><pre><span></span>cfgov-refresh/cfgov/unprocessed/css/atoms/
cfgov-refresh/cfgov/unprocessed/css/molecules/
cfgov-refresh/cfgov/unprocessed/css/organisms/
</pre></div>


<h4 id="javascript_1">JavaScript</h4>
<div class="highlight"><pre><span></span>cfgov-refresh/cfgov/unprocessed/js/atoms/
cfgov-refresh/cfgov/unprocessed/js/molecules/
cfgov-refresh/cfgov/unprocessed/js/organisms/
</pre></div>


<h4 id="test">Test</h4>
<div class="highlight"><pre><span></span>cfgov-refresh/test/unit_tests/atoms/
cfgov-refresh/test/unit_tests/molecules/
cfgov-refresh/test/unit_tests/organisms/
</pre></div>


<h4 id="proposed-folder-structure">Proposed Folder Structure</h4>
<div class="highlight"><pre><span></span>cfgov-refresh/cfgov/front-end/molecules/Expandable

Expandable.html
Expandable.css
Expandable.js
Expandable-unit-test.js
README.MD
</pre></div>


<h3 id="javascript-architecture">JavaScript Architecture</h3>
<p>There was considerable discussion on how we should create JS components. The components aren't constructed to be used on SPAs (Single Page Applications). They are built to be rendered on the sever and then enhanced via JavaScript on the client. The basic interface for the components is as follows:</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">AtomicComponent</span><span class="p">(</span> <span class="nx">domElement</span> <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Ensure the passed in Element is in the DOM.</span>
    <span class="c1">// Query and store references to sub-elements.</span>
    <span class="c1">// Instantiate child atomic components.</span>
    <span class="c1">// Bind necessary events for referenced DOM elements.</span>
    <span class="c1">// Perform other initialization related tasks.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">init</span><span class="p">(){}</span>

    <span class="c1">// General teardown function</span>
    <span class="c1">// We don&#39;t remove the element from the DOM so</span>
    <span class="c1">// we need to unbind the events.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">destroy</span><span class="p">(){}</span>
<span class="p">}</span>
</pre></div>


<p>We aren't testing for interface adherence but we probably should. We generally favor composition over inheritance. You can get more information by reading the following:</p>
<h4 id="articles">Articles</h4>
<p><a href="https://medium.com/javascript-scene/a-simple-challenge-to-classical-inheritance-fans-e78c2cf5eead#.mtrvhcjiw">A Simple Challenge to Classical Inheritance Fans</a>
<a href="https://www.youtube.com/watch?v=wfMtDGfHWpA">Composition over Inheritance (Youtube)</a></p>
<h4 id="code-and-related-prs">Code and Related PRs</h4>
<p><a href="https://github.com/cfpb/cfgov-refresh/pull/916">View Unit Test</a>
<a href="http://jsfiddle.net/0j9u66h0/9/">Expandable example 1</a>
<a href="https://jsfiddle.net/cpsyLy3L/2/">Expandable example 2</a></p>
<h2 id="component-build-pipeline">Component Build Pipeline</h2>
<h4 id="gulp">Gulp</h4>
<p>Gulp is used as a task automation tool. A specific breakdown of each task is contained <a href="https://github.com/cfpb/cfgov-refresh#available-gulp-tasks">here</a>.</p>
<h4 id="webpack">Webpack</h4>
<p>Wepback is used as a module bundler although it's capable of more. We create page, global, and atomic specific bundles. The configuration for the bundles is contained in webpack-config.js. An explanation for the usage of each bundle is contained in scripts.js.</p>
<h4 id="routes">Routes</h4>
<p>Routes are used to serve JavaScript bundles to the browser based on the requested URL or Wagtail page Media property. The happens via code contained in base.html.</p>
<h4 id="basehtml">Base.html</h4>
<p>This file serves as the base document for serving up assets and content. It's currently very complicated, obtrusive, and needs to be refactored.</p>
<h4 id="wagtail-page-media-property">Wagtail Page Media Property</h4>
<p>Each Atomic component has a media property which list the JavaScript files that should be rendered via base.html. When a page is requested via the browser, code contained in base.html will loop all Atomic components for the requested page and render the appropriate Atomic JavaScript bundles.</p>
<h4 id="questions-and-concerns">Questions and Concerns</h4>
<ul>
<li>How do we support Single Page Applications and be functional when JavaScript is disabled?</li>
<li>How do we ensure creation of performant atomic components?</li>
<li>Is the codebase lacking uniformity?</li>
<li>CSS bloat when multiple components are on the same page but from different Django apps.</li>
<li>Ensuring simplicity over complexity.</li>
</ul>
            </section>
        </div>

        <footer role="contentinfo">
            <div class="wrap">
                This project is maintained by <a href="https://cfpb.github.io">The Consumer Financial Protection Bureau</a>.

                <p>Hosted on <a href="http://pages.github.com/">GitHub Pages</a>.</p>
            </div>
        </footer>
    </div>
</body>
</html>
