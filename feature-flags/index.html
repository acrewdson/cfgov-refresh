<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <title>Feature flags - cfgov-refresh</title>
    
    

    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/syntax.css">
    

    
    <style type="text/css">
        .sidebar-nav a:hover,
        .sidebar-nav a:focus,
        .sidebar-nav a:active,
        .sidebar-nav a.sidebar-nav-active {
            border-left-color: #2CB34A;
        }
        header {
            border-bottom-color: #2CB34A;
        }
    </style>
    

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
      <script src="../js/respond.min.js"></script>
    <![endif]--> 
</head>

<body>
    
    <div class="container">
        <header role="banner">
            <div class="wrap">
                
                <img class="logo" src="https://cfpb.github.io/img/logo_210.png" alt="Consumer Financial Protection Bureau">
                
                <h1 class="site-title"><a class="title-link" href="../">cfgov-refresh</a></h1>
            </div>
        </header>
    
        <div class="wrap content">
            <aside>
                <nav class="sidebar-nav" role="navigation">
                    <ul>
                        
                        <li>
                             
                            <a href=".." class="">Introduction</a>

                            
                        </li>
                        
                        <li>
                             
                            <a href="../installation/" class="">Installation</a>

                            
                        </li>
                        
                        <li>
                             
                            <a href="../usage/" class="">Usage</a>

                            
                        </li>
                        
                        <li>
                            
                            <span>Building and Deploying for cf.gov</span>
                            <ul class="secondary-nav">
                                
                                <li>
                                    <a href="../whats-new/" class="">What's new</a>
                                </li>
                                
                                <li>
                                    <a href="../new-projects/" class="">New projects</a>
                                </li>
                                
                                <li>
                                    <a href="../branching-merging/" class="">Branching and merging</a>
                                </li>
                                
                                <li>
                                    <a href="../release-cadence/" class="">Release cadence</a>
                                </li>
                                
                                <li>
                                    <a href="../deployment/" class="">Deployment</a>
                                </li>
                                
                                <li>
                                    <a href="./" class="sidebar-nav-active">Feature flags</a>
                                </li>
                                
                            </ul>
                            
                        </li>
                        
                        <li>
                            
                            <span>Back-end guidelines</span>
                            <ul class="secondary-nav">
                                
                                <li>
                                    <a href="../wagtail-migrations/" class="">Wagtail and Django migrations</a>
                                </li>
                                
                                <li>
                                    <a href="../django-to-wagtail/" class="">Wagtail Pages vs Django views</a>
                                </li>
                                
                            </ul>
                            
                        </li>
                        
                        <li>
                            
                            <span>Front-end guidelines</span>
                            <ul class="secondary-nav">
                                
                                <li>
                                    <a href="../atomic-structure/" class="">Atomic structure and design</a>
                                </li>
                                
                                <li>
                                    <a href="../notes-on-atomic-design/" class="">Notes on adapting atomic design</a>
                                </li>
                                
                                <li>
                                    <a href="../notes-on-frameworks/" class="">Notes on frameworks</a>
                                </li>
                                
                            </ul>
                            
                        </li>
                        
                        <li>
                             
                            <a href="../testing/" class="">Testing</a>

                            
                        </li>
                        
                        <li>
                             
                            <a href="../development-tips/" class="">Development tips</a>

                            
                        </li>
                        
                    </ul>
                </nav>
            </aside>

            <section id="main" class="main-content" role="main">
                <h1 id="feature-flags">Feature flags</h1>
<p>Feature flags are implemented using our <a href="https://github.com/cfpb/wagtail-flags">Wagtail-Flags</a> app. The <a href="https://github.com/cfpb/wagtail-flags/blob/master/README.md">README</a> contains an overview and examples of how to use feature flags in Wagtail.</p>
<p><img alt="Feature flags" src="../img/image02.png" /></p>
<p>Here flags can added, enabled, or disabled:</p>
<p><img alt="Feature flags" src="../img/image00.png" /></p>
<p>The flag consists of a single string (by convention all uppercase, with underscores instead of whitespace). Flags are disabled by default, and checks for flags that do not exist will return False.</p>
<p>Once a flag has been created it can be checked in Python and Jinja2 templates using the functions <a href="https://github.com/cfpb/wagtail-flags/blob/master/README.md#usage">documented in the Wagtail-Flags README</a>.</p>
<h2 id="python-example">Python example</h2>
<pre><code class="python">from flags.template_functions import flag_enabled, flag_disabled

if flag_enabled(request, 'BETA_NOTICE'):
    print(“Beta notice banner will be displayed”)

if flag_disabled(request, 'BETA_NOTICE'):
    print(“Beta notice banner will not be displayed”)
</code></pre>

<p>The <code>flags_enabled</code> method is also provided as a shortcut when checking that multiple flags are all set.</p>
<pre><code class="python">from flags.template_functions import flags_enabled

if flags_enabled(request, 'FLAG1', 'FLAG2', 'FLAG3'):
    print(“All flags were set”)

</code></pre>

<p>You can also use the <code>flag_required</code> method decorator to mark Django views as requiring a flag. The default behavior is to return a 404 if the flag is not set, but an optional fallback view function can be specified instead.</p>
<pre><code class="python">from flags.decorators import flag_required

@flag_required('MY_FLAG')
def view_requiring_flag(request):
    retrun HttpResponse('flag was set')

def other_view(request):
    return HttpResponse('flag was not set')

@flag_required('MY_FLAG', fallback_view=other_view)
def view_with_fallback(request):
    return HttpResponse('flag was set')
</code></pre>

<h2 id="jinja2-template-example">Jinja2 template example:</h2>
<pre><code>{% if flag_enabled(request, 'BETA_NOTICE') and show_banner %}
    &lt;div class=&quot;m-global-banner&quot;&gt;
I’m a beta banner.   
    &lt;/div&gt;
{% endif %}
</code></pre>

<h2 id="feature-flag-hygiene">Feature flag hygiene</h2>
<p>Feature flags should be rare and ephemeral. Changes should be small and frequent, and not big-bang releases, and flags that are no longer used should be cleaned up and removed from code and the database.</p>
            </section>
        </div>

        <footer role="contentinfo">
            <div class="wrap">
                This project is maintained by <a href="https://cfpb.github.io">The Consumer Financial Protection Bureau</a>.

                <p>Hosted on <a href="http://pages.github.com/">GitHub Pages</a>.</p>
            </div>
        </footer>
    </div> 
</body>
</html>
